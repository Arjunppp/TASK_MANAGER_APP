<!DOCTYPE html>
<html lang="en">
<%- include('partials/headPartials', { title: 'Project Page', styles: 'projectPage.css' }) %>

<body>
    <div class="container mt-4">
        <div class="row mb-3">
            <div class="col-3">
                <button class="btn btn-primary">Edit Project</button>
            </div>
            <div class="col-3 text-center">
                <button type="button" id="create-task" class="btn btn-success" data-bs-toggle="modal"
                    data-bs-target="#exampleModal">+ Create Task</button>
                <!-- Modal -->
                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Create New Task</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body" id="modal-body">
                                <!-- Task creation form can go here -->
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" id="save-task">Save Task</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-3 text-end">
                <a href="/logout" class="btn btn-danger">Logout</a>
            </div>
        </div>

        <% if(locals.projectDetails) { %>
            <% projectDetails.forEach((each) => { %>
                <div project-id="<%= each._id %>" class="mb-4 p-3 border rounded" id="project-details">
                    <div class="row mb-2">
                        <h2>Project Details:</h2>
                    </div>
                    <div class="row mb-2">
                        <h4>Project Title: <%= each.projectName %></h4>
                    </div>
                    <div class="row mb-2">
                        <p>Project Specification: <%= each.projectSpecification %></p>
                    </div>
                    <div class="row mb-2" id="team-members">
                        <h5>Team Members:</h5>
                        <% each.teamMembers.forEach((mem) => { %>
                            <p class="ml-3"><%= mem %></p>
                        <% }) %>
                    </div>
                    <div class="row mb-2">
                        <p>Start Date: <%= each.startDate.toISOString().slice(0, 10).split('-').reverse().join('-') %></p>
                    </div>
                    <div class="row mb-2">
                        <p>End Date: <%= each.dueDate.toISOString().slice(0, 10).split('-').reverse().join('-') %></p>
                    </div>
                </div>
            <% }) %>
        <% } %>

        <% if(locals.tasksAssociated) { %>
            <div class="tasks-section">
                <h3>Associated Tasks:</h3>
                <% tasksAssociated.forEach((each) => { %>
                    <div task-id="<%= each._id %>" class="mb-4 p-3 task-box border rounded">
                        <div class="row">
                            <div class="col-4">
                                <p><strong>Task:</strong> <%= each.task %></p>
                            </div>
                            <div class="col-4">
                                <p><strong>Employee:</strong> <%= each.employee %></p>
                            </div>
                            <div class="col-4">
                                <p><strong>Status:</strong> <%= each.taskStatus %></p>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        <% } %>
    </div>

    <%- include('partials/scriptPartials', { scripts: 'project.js' }) %>
</body>

</html>
